<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Happy Chocolate Day!</title>
  <!-- Google Fonts: Tangerine for messages and Pacifico for the wrapper text -->
  <link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@700&family=Pacifico&display=swap" rel="stylesheet">
  <!-- GSAP for smooth animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <style>
    /* Cool animated background */
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(45deg, #1a2a6c, #b21f1f, #fdbb2d);
      background-size: 600% 600%;
      animation: gradientBG 16s ease infinite;
      font-family: sans-serif;
      overflow: hidden;
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    /* Container for the entire animation */
    #animation-container {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    /* Glittering lavender wrapper styling */
    #wrapper {
      position: absolute;
      width: 450px;
      height: 250px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #E6E6FA, #D8BFD8);
      animation: glitter 3s infinite;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      border-radius: 8px;
      cursor: pointer;
      z-index: 3;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    @keyframes glitter {
      0% { filter: brightness(1); }
      50% { filter: brightness(1.2); }
      100% { filter: brightness(1); }
    }
    /* Main wrapper text */
    #wrapper-text {
      font-family: 'Pacifico', cursive;
      font-size: 36px;
      background: linear-gradient(45deg, #ff6b6b, #f8e71c, #7ed321);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
    }
    /* Side text displayed below the main text in a small, readable font */
    #wrapper-side-text {
      margin-top: 5px;
      font-size: 12px;
      font-family: sans-serif;
      color: #333;
      opacity: 0.8;
      text-align: center;
    }
    /* Chocolate bar container: grid stays fixed even when pieces fade */
    #chocolate-bar {
      position: absolute;
      width: 450px;
      height: 250px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 10px;
      z-index: 2;
      opacity: 0;
    }
    /* Each chocolate piece (grid cell remains even when faded) */
    .chocolate-piece {
      background: linear-gradient(145deg, #3D1C02, #5a2e0f);
      border-radius: 4px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: opacity 0.3s;
    }
    /* Message display styling */
    #message {
      position: absolute;
      bottom: 30px;
      width: 100%;
      text-align: center;
      font-family: 'Tangerine', cursive;
      font-size: 3rem;
      color: #9A031E;
      opacity: 0;
      z-index: 5;
    }
    /* Container for falling chocolates (unused in final celebration) */
    #falling-chocolates {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 4;
    }
    /* Style for each falling chocolate (if needed later) */
    .falling-chocolate {
      position: absolute;
      width: 30px;
      height: 20px;
      background: linear-gradient(145deg, #3D1C02, #5a2e0f);
      border-radius: 4px;
      box-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }
    /* Particle styling (chocolate crumbs) */
    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #3D1C02;
      border-radius: 50%;
      pointer-events: none;
      opacity: 0.8;
    }
    /* Floating heart container */
    #heart-container {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 6;
    }
    /* Floating heart shape */
    .heart {
      position: absolute;
      width: 30px;
      height: 30px;
      background: radial-gradient(circle, rgba(154,3,30,1) 0%, rgba(255,111,97,1) 100%);
      clip-path: polygon(50% 0%, 61% 10%, 75% 15%, 85% 30%, 90% 45%, 85% 60%, 75% 75%, 50% 100%, 25% 75%, 15% 60%, 10% 45%, 15% 30%, 25% 15%, 39% 10%);
      filter: drop-shadow(0 0 8px rgba(255,111,97,1));
    }
  </style>
</head>
<body>
  <div id="animation-container">
    <!-- Glittering lavender wrapper with texts -->
    <div id="wrapper">
      <div id="wrapper-text">Gadhu's fav choco</div>
      <div id="wrapper-side-text">made with love from begusarai</div>
    </div>
    <!-- Chocolate bar: 6 pieces in a fixed grid -->
    <div id="chocolate-bar">
      <div class="chocolate-piece" data-message="You're sweeter than chocolate!"></div>
      <div class="chocolate-piece" data-message="Every moment with you melts my heart."></div>
      <div class="chocolate-piece" data-message="Your love is as rich as the finest cocoa."></div>
      <div class="chocolate-piece" data-message="Life is sweeter with you by my side."></div>
      <div class="chocolate-piece" data-message="A bite of love, a taste of joy."></div>
      <div class="chocolate-piece" data-message="You make my world a delicious place."></div>
    </div>
    <!-- Message container -->
    <div id="message"></div>
    <!-- Container for falling chocolates (unused in final celebration) -->
    <div id="falling-chocolates"></div>
    <!-- Container for floating hearts -->
    <div id="heart-container"></div>
  </div>
  
  <script>
    /*****************************
     * Global Variables & Setup  *
     *****************************/
    let activeBite = null;
    let biteTimeout = null;
    let bittenCount = 0;
    const totalPieces = 6;
    
    const wrapper = document.getElementById('wrapper');
    const chocolateBar = document.getElementById('chocolate-bar');
    const messageEl = document.getElementById('message');
    
    /*****************************
     * Floating Heart Animation  *
     *****************************/
    function createFloatingHeart() {
      const heart = document.createElement('div');
      heart.classList.add('heart');
      // Start at a random horizontal position along the bottom
      heart.style.left = Math.random() * 80 + 10 + '%';
      heart.style.top = '100%';
      document.getElementById('heart-container').appendChild(heart);
      gsap.to(heart, {
        y: -window.innerHeight - 50,
        duration: 5 + Math.random() * 3,
        ease: "power1.inOut",
        repeat: -1,
        delay: Math.random() * 2,
        onRepeat: () => {
          heart.style.left = Math.random() * 80 + 10 + '%';
        }
      });
      gsap.to(heart, {
        scale: 1.2,
        duration: 0.8,
        yoyo: true,
        repeat: -1,
        ease: "power1.inOut"
      });
    }
    // Create a few floating hearts for extra charm
    for (let i = 0; i < 5; i++) {
      createFloatingHeart();
    }
    
    /*****************************
     * Wrapper Peel Animation    *
     *****************************/
    wrapper.addEventListener('click', () => {
      gsap.to(wrapper, {
        duration: 1.5,
        rotationY: 90,
        x: 300,
        ease: "power2.inOut",
        onComplete: () => {
          wrapper.style.display = 'none';
          gsap.to(chocolateBar, { duration: 1, opacity: 1 });
        }
      });
      // Fun particle effect as the wrapper peels off
      for (let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        particle.style.left = (window.innerWidth / 2) + 'px';
        particle.style.top = (window.innerHeight / 2) + 'px';
        document.body.appendChild(particle);
        gsap.to(particle, {
          duration: 1.5,
          x: (Math.random() - 0.5) * 200,
          y: (Math.random() - 0.5) * 200,
          opacity: 0,
          scale: 0,
          ease: "power2.out",
          onComplete: () => { particle.remove(); }
        });
      }
    });
    
    /*****************************
     * Display Romantic Message  *
     *****************************/
    function showMessage(text) {
      messageEl.textContent = text;
      gsap.killTweensOf(messageEl);
      gsap.fromTo(messageEl, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.5, ease: "power2.out" });
    }
    
    /*************************************
     * Chocolate Crumb Particle Effect   *
     *************************************/
    function createCrumbParticles(piece) {
      const rect = piece.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      for (let i = 0; i < 10; i++) {
        const crumb = document.createElement('div');
        crumb.classList.add('particle');
        crumb.style.left = cx + 'px';
        crumb.style.top = cy + 'px';
        document.body.appendChild(crumb);
        gsap.to(crumb, {
          duration: 1,
          x: (Math.random() - 0.5) * 100,
          y: (Math.random() - 0.5) * 100,
          opacity: 0,
          scale: 0,
          ease: "power2.out",
          onComplete: () => { crumb.remove(); }
        });
      }
    }
    
    /*************************************
     * Bite Animation for a Chocolate    *
     *************************************/
    function bitePiece(piece) {
      if (activeBite && activeBite !== piece) {
        activeBite = null;
        if (biteTimeout) clearTimeout(biteTimeout);
      }
      activeBite = piece;
      const msg = piece.getAttribute('data-message');
      showMessage(msg);
      
      // Clone the piece for a splitting animation
      const rect = piece.getBoundingClientRect();
      const pieceClone = piece.cloneNode(true);
      pieceClone.style.position = 'absolute';
      pieceClone.style.left = rect.left + 'px';
      pieceClone.style.top = rect.top + 'px';
      pieceClone.style.margin = 0;
      pieceClone.style.transformOrigin = "center center";
      document.body.appendChild(pieceClone);
      
      // Create left and right halves using CSS clip-path
      const leftHalf = pieceClone.cloneNode(true);
      const rightHalf = pieceClone.cloneNode(true);
      leftHalf.style.clipPath = "inset(0 50% 0 0)";
      rightHalf.style.clipPath = "inset(0 0 0 50%)";
      document.body.appendChild(leftHalf);
      document.body.appendChild(rightHalf);
      
      // Animate the halves moving apart and fading out
      gsap.to(leftHalf, { duration: 1, x: -50, opacity: 0, ease: "power2.out", onComplete: () => { leftHalf.remove(); }});
      gsap.to(rightHalf, { duration: 1, x: 50, opacity: 0, ease: "power2.out", onComplete: () => { rightHalf.remove(); }});
      
      // Emit chocolate crumb particles
      createCrumbParticles(piece);
      
      // Fade out the original piece (keeping its grid space) and mark it as bitten
      gsap.to(piece, { duration: 0.5, opacity: 0, delay: 1, onComplete: () => { 
          piece.style.pointerEvents = 'none';
          piece.dataset.bit = "true";
          bittenCount++;
          checkFinalCelebration();
      }});
      
      if (biteTimeout) clearTimeout(biteTimeout);
      biteTimeout = setTimeout(() => { activeBite = null; }, 10000);
    }
    
    // Attach click event listeners to each chocolate piece
    const pieces = document.querySelectorAll('.chocolate-piece');
    pieces.forEach(piece => {
      piece.addEventListener('click', (e) => {
        e.stopPropagation();
        if (!piece.dataset.bit) {
          bitePiece(piece);
        }
      });
    });
    
    /*************************************
     * Trigger Final Celebration         *
     *************************************/
    function checkFinalCelebration() {
      // When all pieces are bitten, trigger the final celebration
      const unbitPieces = document.querySelectorAll('.chocolate-piece:not([data-bit])');
      if (unbitPieces.length === 0) {
        setTimeout(finalCelebration, 1000);
      }
    }
    
    // Final celebration: replace any lingering message with the final message, display it for 10 seconds, then fade it out
    function finalCelebration() {
      gsap.killTweensOf(messageEl);
      gsap.to(messageEl, { duration: 0.5, opacity: 0, onComplete: () => {
          messageEl.textContent = "Thank you for being with me till this time ❤️";
          gsap.fromTo(messageEl, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.5, ease: "power2.out", onComplete: () => {
              gsap.to(messageEl, { duration: 1, opacity: 0, delay: 10 });
          }});
      }});
    }
  </script>
</body>
</html>
